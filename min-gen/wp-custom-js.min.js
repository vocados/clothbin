const prefix='clothbin';let sidoToDest={};const loadMap=()=>{let map=new naver.maps.Map('map',{zoom:12,zoomControl:true,zoomControlOptions:{position:naver.maps.Position.TOP_RIGHT}});let markers=[];let bounds=new naver.maps.LatLngBounds();let infoWindow=new naver.maps.InfoWindow({content:''});for(let row of data){let position=new naver.maps.LatLng(row.lat,row.lng);let marker=new naver.maps.Marker({map:map,position:position,});bounds.extend(position);markers.push(marker);if(row.title){naver.maps.Event.addListener(marker,'click',function(){infoWindow.setContent('<div>'+row.title+'</div>');infoWindow.open(map,marker);});}}
map.fitBounds(bounds);}
const simpleFetch=(url,callBack)=>{fetch(url).then(response=>{if(!response.ok){throw new Error("JSON 데이터를 불러오는 중 문제가 발생했습니다.");}
return response.json();}).then(jsonData=>{callBack(jsonData);}).catch(error=>{callBack();});}
const getCenter=(coordinates)=>{let totalLat=0;let totalLng=0;coordinates.forEach(coord=>{totalLat+=coord.lat;totalLng+=coord.lng;});const centerLat=totalLat/coordinates.length;const centerLng=totalLng/coordinates.length;return{lat:centerLat,lng:centerLng};}
let stickyAdEl=null;let gWidth=null;let adClose=null;function renderStickyAd(trackAd){const width=window.innerWidth;if((gWidth&&gWidth===width)||adClose){return;}
gWidth=width;if(stickyAdEl){stickyAdEl.parentNode.removeChild(stickyAdEl);stickyAdEl=null;}
const container=document.createElement("div");container.id="sticky-ad";container.className="fixed bottom-0 left-0 w-full bg-gray-100/70 z-[9999]";const inner=document.createElement("div");inner.style.maxWidth="100%";inner.style.margin="0 auto";inner.style.display="flex";inner.style.justifyContent="center";inner.style.alignItems="center";inner.style.padding="6px 8px";inner.style.boxSizing="border-box";const adWrap=document.createElement("div");adWrap.style.display="flex";adWrap.style.alignItems="center";adWrap.style.gap="6px";adWrap.style.margin="0 auto";const adBox=document.createElement("div");adBox.style.display="flex";adBox.style.alignItems="center";adBox.style.justifyContent="center";adBox.style.background="#fff";adBox.style.overflow="hidden";const closeBtn=document.createElement("button");closeBtn.style.flexShrink="0";closeBtn.innerHTML="✕";closeBtn.style.width="32px";closeBtn.style.height="32px";closeBtn.style.lineHeight="32px";closeBtn.style.display="flex";closeBtn.style.alignItems="center";closeBtn.style.justifyContent="center";closeBtn.style.borderRadius="50%";closeBtn.style.border="1px solid #d1d5db";closeBtn.style.background="#fff";closeBtn.style.cursor="pointer";closeBtn.style.flexShrink="0";closeBtn.style.color="#6b7280";closeBtn.onclick=function(){if(stickyAdEl){stickyAdEl.remove();stickyAdEl=null;adClose=true;document.body.style.paddingBottom="";}};if(width<768){adBox.style.width="320px";adBox.style.height="100px";adBox.style.maxHeight="100px";adBox.style.background="#fff";adBox.innerHTML=['<ins class="adsbygoogle"','style="display:inline-block;width:320px;height:100px"','data-ad-client="ca-pub-0031623727468371"','data-ad-slot="3363648326"></ins>'].join('');document.body.style.paddingBottom="120px";}else{adBox.style.width="728px";adBox.style.height="90px";adBox.style.maxHeight="90px";adBox.style.background="#fff";adBox.innerHTML=['<ins class="adsbygoogle"','style="display:inline-block;width:728px;height:90px"','data-ad-client="ca-pub-0031623727468371"','data-ad-slot="2050566650"></ins>'].join('');document.body.style.paddingBottom="110px";}
adBox.style.overflow="hidden";container.style.height=width<768?"100px":"90px";container.style.position="fixed";container.style.bottom="0";container.style.left="0";container.style.width="100%";container.style.background="rgba(243,244,246,0.7)";container.style.zIndex="9999";container.style.display="block";adWrap.appendChild(adBox);adWrap.appendChild(closeBtn);inner.appendChild(adWrap);container.appendChild(inner);document.body.appendChild(container);stickyAdEl=container;try{(window.adsbygoogle=window.adsbygoogle||[]).push({});}
catch(e){}
try{if(trackAd){setTimeout(()=>{const adBox=document.querySelector("#sticky-ad ins.adsbygoogle");if(adBox){const width=adBox.offsetWidth;const height=adBox.offsetHeight;gtag('event','ad_load',{event_category:width+"X"+height,});}},1000);}}
catch(e){}}
document.addEventListener("DOMContentLoaded",()=>{try{if(window.location.pathname!=='/privacy-policy/'){renderStickyAd(true);window.addEventListener("resize",()=>{clearTimeout(window.__adResizeTimer);window.__adResizeTimer=setTimeout(renderStickyAd,150);});}}
catch(e){}
if(window.location.pathname.startsWith("/location")&&data){loadMap()}
const shareBtn=document.getElementById('share-btn');if(shareBtn){shareBtn.addEventListener('click',function(){const url=window.location.href;if(navigator.share){navigator.share({url:url}).then(()=>{console.log('공유 성공');}).catch((error)=>{console.error('공유 실패:',error);});}
else{navigator.clipboard.writeText(url).then(()=>{alert('URL이 클립보드에 복사되었습니다.');}).catch((error)=>{console.error('클립보드 복사 실패:',error);alert('URL 복사 실패. 수동으로 복사해 주세요.');});}});}});if(window.location.pathname=="/"||window.location.pathname==""){const jsonUrl=`/wp-content/${prefix}/sido.json`;simpleFetch(jsonUrl,(data)=>{const citySelect=document.getElementById('city');const gugunSelect=document.getElementById('gugun');if(citySelect){Object.entries(data).forEach(([name])=>{const option=document.createElement('option');option.value=name;option.textContent=name;citySelect.appendChild(option);});}
document.addEventListener('change',(event)=>{if(event.target&&event.target.id==='city'){const city=event.target.value;gugunSelect.innerHTML='<option value="">구군을 선택해주세요</option>';if(city&&data[city]){const guguns=Object.keys(data[city]);guguns.sort((a,b)=>a.localeCompare(b,'ko')).forEach(gugun=>{const option=document.createElement('option');option.value=gugun;option.textContent=gugun;gugunSelect.appendChild(option);});}}
else if(event.target&&event.target.id==='gugun'){const city=citySelect.value;const gugun=gugunSelect.value;const buttonContainer=document.getElementById("main-content");if(city&&gugun){const jsonUrl=`/wp-content/clothbin/sido-to-dest.json`;simpleFetch(jsonUrl,(destData)=>{buttonContainer.innerHTML='';const key=`${city}-${gugun}`.replace(" ","-");if(destData[key]){Object.entries(destData[key]).forEach(([dong,url])=>{const button=document.createElement('button');button.textContent=dong;button.onclick=()=>{window.location.href=url;};button.style.marginRight='0.3em';button.style.marginBottom='0.3em';button.style.borderRadius='22px';buttonContainer.appendChild(button);});}});}}
else if(event.target&&event.target.id==='dong'){}});});}